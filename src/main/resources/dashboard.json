{
  "apiVersion" : "dashboard.grafana.app/v1beta1",
  "kind" : "Dashboard",
  "metadata" : {
    "name" : "my-dashboard"
  },
  "spec" : {
    "uid" : "grafana-monitoring-agent",
    "title" : "David's Grafana monitoring agent dashboard",
    "tags" : [ "generated", "grafana-foundation-sdk", "monitoring-agent" ],
    "timezone" : "browser",
    "editable" : true,
    "graphTooltip" : 0,
    "time" : {
      "from" : "now-60m",
      "to" : "now"
    },
    "timepicker" : {
      "hidden" : false,
      "refresh_intervals" : [ "5s", "10s", "30s", "1m", "5m", "15m", "30m", "1h", "2h", "1d" ]
    },
    "fiscalYearStartMonth" : 0,
    "refresh" : "30s",
    "schemaVersion" : 41,
    "panels" : [ {
      "type" : "row",
      "collapsed" : false,
      "title" : "CPU Usage",
      "gridPos" : {
        "h" : 1,
        "w" : 24,
        "x" : 0,
        "y" : 0
      },
      "id" : 0,
      "panels" : [ ]
    }, {
      "type" : "timeseries",
      "targets" : [ {
        "expr" : "avg_over_time(cpu_usage{job=~\"$job\"}[5m])",
        "legendFormat" : "{{instance}} {{job}}",
        "refId" : "{{job}} configured"
      } ],
      "title" : "Average Over Time CPU Usage",
      "description" : "Average Over Time CPU Usage",
      "transparent" : false,
      "datasource" : {
        "type" : "prometheus",
        "uid" : "$prometheus_datasource"
      },
      "gridPos" : {
        "h" : 7,
        "w" : 12,
        "x" : 0,
        "y" : 1
      },
      "options" : {
        "legend" : {
          "displayMode" : "list",
          "placement" : "bottom",
          "showLegend" : true,
          "calcs" : [ ]
        },
        "tooltip" : {
          "mode" : "single",
          "sort" : "none"
        }
      },
      "fieldConfig" : {
        "defaults" : {
          "unit" : "short",
          "custom" : {
            "drawStyle" : "line",
            "gradientMode" : "none",
            "thresholdsStyle" : {
              "mode" : "off"
            },
            "lineWidth" : 1.0,
            "fillOpacity" : 15.0,
            "showPoints" : "auto",
            "pointSize" : 5.0,
            "spanNulls" : true,
            "axisBorderShow" : false
          }
        },
        "overrides" : [ ]
      }
    }, {
      "type" : "table",
      "targets" : [ {
        "expr" : "sum(remote_write_status_total{job=~\"$job\"}[5m])",
        "instant" : false,
        "range" : true,
        "format" : "table",
        "legendFormat" : "{{instance}} {{status}}",
        "intervalFactor" : 2.0,
        "refId" : "{{job}} configured"
      } ],
      "title" : "Average Over Time CPU Usage",
      "description" : "Average Over Time CPU Usage",
      "transparent" : false,
      "datasource" : {
        "type" : "prometheus",
        "uid" : "$prometheus_datasource"
      },
      "gridPos" : {
        "h" : 9,
        "w" : 12,
        "x" : 12,
        "y" : 1
      },
      "fieldConfig" : {
        "defaults" : {
          "unit" : "short"
        },
        "overrides" : [ ]
      }
    }, {
      "type" : "timeseries",
      "targets" : [ {
        "expr" : "avg_over_time(cpu_usage{job=~\"$job\"}[5m])",
        "legendFormat" : "{{instance}} {{job}}",
        "refId" : "{{job}} configured"
      } ],
      "title" : "Average Over Time CPU Usage",
      "description" : "Average Over Time CPU Usage",
      "transparent" : false,
      "datasource" : {
        "type" : "prometheus",
        "uid" : "$prometheus_datasource"
      },
      "gridPos" : {
        "h" : 7,
        "w" : 12,
        "x" : 0,
        "y" : 10
      },
      "options" : {
        "legend" : {
          "displayMode" : "table",
          "placement" : "bottom",
          "showLegend" : true,
          "calcs" : [ "min", "max", "mean", "last" ]
        },
        "tooltip" : {
          "mode" : "single",
          "sort" : "none"
        }
      },
      "fieldConfig" : {
        "defaults" : {
          "unit" : "short",
          "custom" : {
            "drawStyle" : "line",
            "gradientMode" : "none",
            "thresholdsStyle" : {
              "mode" : "off"
            },
            "lineWidth" : 1.0,
            "fillOpacity" : 15.0,
            "showPoints" : "never",
            "pointSize" : 5.0,
            "axisGridShow" : true,
            "spanNulls" : true,
            "axisBorderShow" : false
          }
        },
        "overrides" : [ ]
      }
    }, {
      "type" : "gauge",
      "targets" : [ {
        "expr" : "(sum(rate(remote_write_status_total{job=~\"$job\", status=\"200\"}[5m])) / sum(rate(remote_write_status_total{job=~\"$job\"}[5m]))) * 100",
        "instant" : true,
        "range" : false,
        "legendFormat" : "{{instance}} {{job}}",
        "refId" : "{{job}} configured"
      } ],
      "title" : "Remote Write API Success Rate (%)",
      "description" : "Average Over Time CPU Usage",
      "transparent" : false,
      "datasource" : {
        "type" : "prometheus",
        "uid" : "$prometheus_datasource"
      },
      "gridPos" : {
        "h" : 7,
        "w" : 12,
        "x" : 12,
        "y" : 10
      },
      "options" : {
        "showThresholdLabels" : false,
        "showThresholdMarkers" : true,
        "sizing" : "auto",
        "minVizWidth" : 75,
        "reduceOptions" : {
          "calcs" : [ ]
        },
        "minVizHeight" : 75,
        "orientation" : "auto"
      },
      "fieldConfig" : {
        "defaults" : {
          "unit" : "percent",
          "thresholds" : {
            "mode" : "absolute",
            "steps" : [ {
              "value" : 99.0,
              "color" : "red"
            }, {
              "value" : 99.9,
              "color" : "yellow"
            }, {
              "value" : 100.0,
              "color" : "green"
            } ]
          }
        },
        "overrides" : [ ]
      }
    } ],
    "templating" : {
      "list" : [ {
        "type" : "datasource",
        "name" : "prometheus_datasource",
        "label" : "Data source",
        "skipUrlSync" : false,
        "query" : "prometheus",
        "multi" : false,
        "allowCustomValue" : true,
        "includeAll" : false,
        "regex" : "(?!grafanacloud-usage|grafanacloud-ml-metrics).+",
        "auto" : false,
        "auto_min" : "10s",
        "auto_count" : 30
      }, {
        "type" : "query",
        "name" : "job",
        "label" : "job",
        "skipUrlSync" : false,
        "query" : "label_values(cpu_usage, job)",
        "datasource" : {
          "type" : "prometheus",
          "uid" : "$prometheus_datasource"
        },
        "current" : {
          "selected" : true,
          "text" : [ "All" ],
          "value" : [ "$__all" ]
        },
        "multi" : true,
        "allowCustomValue" : true,
        "refresh" : 2,
        "sort" : 1,
        "includeAll" : true,
        "auto" : false,
        "auto_min" : "10s",
        "auto_count" : 30
      }, {
        "type" : "query",
        "name" : "instance",
        "label" : "instance",
        "skipUrlSync" : false,
        "query" : "label_values(cpu_usage{job=~\"$job\"}, instance)",
        "datasource" : {
          "type" : "prometheus",
          "uid" : "$prometheus_datasource"
        },
        "current" : {
          "selected" : true,
          "text" : [ "All" ],
          "value" : [ "$__all" ]
        },
        "multi" : true,
        "allowCustomValue" : true,
        "refresh" : 2,
        "sort" : 1,
        "includeAll" : true,
        "auto" : false,
        "auto_min" : "10s",
        "auto_count" : 30
      } ]
    },
    "annotations" : { }
  }
}